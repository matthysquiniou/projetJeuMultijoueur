#include "pch.h"

cpu_ray::cpu_ray()
{
	Identity();
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void cpu_ray::Identity()
{
	pos = { 0.0f, 0.0f, 0.0f };
	dir = { 0.0f, 0.0f, 1.0f };
}

void XM_CALLCONV cpu_ray::ToLocal(cpu_ray& out, FXMMATRIX invWorld)
{
	XMVECTOR roW = XMLoadFloat3(&pos);
	XMVECTOR rdW = XMLoadFloat3(&dir);

	XMVECTOR roL = XMVector3TransformCoord(roW, invWorld);
	XMVECTOR rdL = XMVector3TransformNormal(rdW, invWorld); // pas de translation

	XMStoreFloat3(&out.pos, roL);
	XMStoreFloat3(&out.dir, rdL);
}
